# 更新日志 (Changelog)

所有本项目的重大更新都将记录在此文件中。

## [0.1.1] - 2026-02-08

### 🐛 修复 (Fixes)

- **依赖安全**: 移除未使用的 `xlsx` 依赖，修复高危安全漏洞（Prototype Pollution + ReDoS）。
- **配置一致性**: 统一端口配置为 8972，所有位置使用共享常量 `APP_CONSTANTS.DEFAULT_SERVER_PORT`。
- **镜像源优化**: 修复 electron-builder 在 macOS 打包时的 404 错误，注释掉不稳定的 npmmirror 镜像源。
- **代码格式化**: 通过 Prettier 自动修复所有格式问题，保证代码规范一致性。

### 🔧 优化 (Improvements)

- **Chrome 插件增强**:
  - 失败计数上限调整至 50 次，增加失败上限视觉化弹窗提示
  - 配置集中化管理（CONFIG 常量），移除魔法数字
  - 指数退避策略优化元素查找性能
  - 所有 taskFailed() 异步调用添加 await 关键字
  - 移除初始化时的冗余 checkResult() 调用
- **文件导入优化**: 支持跨平台换行符（\r\n, \n, \r），明确 UTF-8 编码，防止 watch 重复触发。
- **Logger 重构**: 利用 @chaeco/logger 懒加载特性，移除手动目录创建和动态 require()，代码更简洁。

### 📝 文档 (Documentation)

- **上线检查清单**: 生成完整的上线前检查报告，覆盖类型安全、代码规范、依赖安全、配置管理等维度。

## [0.1.0] - 2026-02-08

### ✨ 新特性 (Features)

- **双重提醒系统**: 集成系统原生通知与强交互对话框（Dialog），确保关键错误与任务完成 100% 触达。
- **精确任务计时**: 数据库新增 `started_at` 字段，实现 Processing 状态下的实时执行耗时显示（Precision Timer）。
- **异常上报机制**: 新增 `/api/task/failed` 接口，允许浏览器插件触发客户端全局警报。
- **状态全链路同步**: 引入 30ms 写入缓冲与全进程 IPC 广播，彻底解决渲染层统计数据更新滞后的问题。

### 🔧 优化 (Improvements)

- **终极稳定性修复**: 彻底重构日志模块（Lazy Delegation 模式）。移除了 Proxy 代理以消除潜在的 JS 引擎阻塞，并引入 `process.chdir` 临时环境切换。
- **环境隔离策略**: 解决了第三方日志库强制在 CWD 创建目录的固有缺陷，确保在 macOS 只读安装目录下 100% 成功启动且不丢失日志。
- **静默降级机制**: 若日志系统在极早期被访问或初始化失败，系统将自动降级至系统控制台（Console），保证窗口显示等核心业务逻辑不被阻塞。
- **网络兼容性**: 全局将 `localhost` 链接替换为底层 `127.0.0.1` 物理回环，大幅提升 Windows 系统下的防火墙通过率。
- **术语规范化**: 全局迁移状态字段 `resolved` -> `success`，统一插件与客户端的业务语境。
- **通知去重**: 逻辑重构，确保任务排空通知仅在 `unprocessed` 接口返回 null 时触发一次。

### 🛠️ 其它 (Others)

- **文档更新**: 重绘 README.md 架构，清晰标注内置 API 协议与状态流转逻辑。

## [0.0.1] - 2026-02-07

### 📢 模块化与商业化

- **品牌重塑**: 正式更名为 `OzonAssist`，确立 Ozon Blue (#005BFF) 品牌色。
- **视觉升级**: 全套高清图标更新（icns/ico/png），包含针对 macOS 优化的渲染。
- **官网发布**: 构建了包含 8 大功能模块的高密度商业落地页，支持移动端适配与 GPU 加速动画。

### ⚙️ 工程化

- **CI/CD**: 配置 GitHub Actions 流水线，实现 Commit 触发自动化多平台（macOS/Win/Linux）打包发布流程。
- **环境隔离**: 完善了本地 SQLite 数据库与浏览器插件的通讯安全协议。

### 🛠️ 其它

- **代码开源**: 整合项目结构，明确开源定位，完善开发者文档。
